# CVE-2025-38063 — Windows IPv6 DestOpt Underflow (DoS/RCE)

> 보고서 내 CVE ID 표기가 **2025-38063**로 기재되어 있으나, 참고 링크는 **2024-38063**로 표기되어 있습니다. 추후 교차 확인 필요.

## Summary
Windows `tcpip.sys`의 IPv6 Destination Options 처리 과정에서 길이 언더플로가 발생해 **커널 힙 오버플로**로 이어지며, 원격 DoS(BSOD) 또는 RCE 가능성이 존재합니다.

## Root Cause
- `Ipv6pProcessOptions → IppSendErrorList` 경로에서 잘못된 옵션을 반복 처리
- 길이 값이 `0 → 0xFFFF`로 언더플로
- 커널 힙 오버플로 발생

## Exploit Flow (요약)
1. IPv6 Destination Options 포함 패킷 전송
2. 옵션 검증 실패 → ErrorList 처리 경로 진입
3. 길이 언더플로 → 힙 오버플로
4. BSOD 또는 커널 RCE 가능

## Repro (요약)
- Scapy 기반 조작 패킷 전송
- 60초 내 다량 패킷 스프레이 → BSOD 재현

## Impact
- **Confidentiality/Integrity/Availability** 모두 High (커널 권한 공격 가능)

## Mitigation
- 2024-08 Patch Tuesday 업데이트 적용
- IPv6 비활성화 또는 확장 헤더(Destination, Fragment) 차단

## Detection Ideas
- `Microsoft-Windows-TCPIP/Operational` 채널 재조립 오류 이벤트 모니터링
- Suricata/Snort에서 IPv6 DestOpt 패킷 패턴 탐지

## References
- Microsoft MSRC / NVD
- MalwareTech PoC 관련 자료
